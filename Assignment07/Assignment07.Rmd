---
title: "Assignment07"
author: "Max Selvaggio"
date: "2022-07-31"
output:
 html_document:
    toc: true
    toc_float: true
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(gamlr)

```


```{r}
setwd("C:\\Users\\mselv\\Documents\\GitHub\\ECO5445SU22\\Assignment06\\data")
prices <- read.csv("prop_prices_reduced.csv")

```

Number 1

```{r}
set.seed(1234)
train <- sample(nrow(prices), 0.9*nrow(prices))

prices.train <- prices[train,]
prices.validate <- prices[-train,]
```

Number 2

```{r}
model <- lm(sale_def ~ bed + bath + area_heated + area + 
              dist_cbd + dist_lakes + pool, data = prices.train)
summary(model)

modelpred <- predict(model,prices.validate)
modelactual <- prices.validate$sale_def

```

Number 3 - Standard LASSO

```{r}
x <- data.matrix(prices.train[, c('bed', 'bath', 'area_heated', 'area', 
                                  'dist_cbd', 'dist_lakes')])

y <- prices.train$sale_def
ym <- as.matrix(y)

Lass <- gamlr(x, log(ym), verb=TRUE)
summary(Lass)

prices.validatem <- prices.validate[-c(1,8)]
test <- as.matrix(prices.validatem)

predict(Lass,test)
```

Number 4 - Ten-fold Regression

```{r}
cvLass <- cv.gamlr(x, log(ym), nfold = 10, verb=TRUE)
summary(cvLass)

predict(cvLass,test)
```

Number 5

```{r}
log(Lass$lambda[which.min(AICc(Lass))])
log(Lass$lambda[which.min(AIC(Lass))])
log(Lass$lambda[which.min(BIC(Lass))])
log(cvLass$lambda.min)
log(cvLass$lambda.1se)



#Original Model RMSE
sqrt(mean((modelactual - modelpred)^2))


```

I am producing negative lambda values somehow. Though I cannot figure out the last part of this assignment, 
I assume based off the experience in class that using the lambda from AICc would create the most accurate
model. I believe I am following how you showed to do the LASSO and ten-fold  functions but my predict
function is not working properly. I got an error message for my "new data" which was saying I need to remove
the first column, which is our y variable (sale def). However, when I remove the first column to be able to
actually run the predict function, it produces 2 digit numbers which are not even close to what y should be.
It does not affect my grade, but I figured explaining my problems would be better than no explanation at all.
